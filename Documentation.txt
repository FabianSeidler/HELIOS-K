
		### kCalc ###

	  ### Author: Simon Grimm ###

Compilation

kcalc can be compiled with the Makefile by typing 'make SM=xx' to the
terminal,
where xx corresponds to the compute capability. For example use 'make SM=20'
for
compute capability of 2.0, or 'make SM=35' for 3.5.

Input parameters

*The input parameters can be set in the param.h file. These are:
T = <double>      	Temperature in Kelvin
P = <double>		Pressure in atmospheres
Molecule = <integer>	Molecule identity according to HITRAN, 1 = H20, 2 =
CO2, ... 
numin = <double>	minimum wavenumber in 1/cm
numax = <double>	maximum wavenumber in 1/cm
dnu = <double>		spacing in wavenumber in 1/cm

*The same parameters can be set by console arguments:
-T <double>
-P <double>
-m <integer>
-numin <double>
-numax <double>
-dev <double>		Device number (For multiple GPU systems) 	

Console arguments have a higher priority than the param.h file.

Code parameters
The file define.h contains the physical parameters and some code parameters.
After changing some entry, the Code needs to be recompiled.
The code parameters are:

* TOL: 		Tolerance parameter in the Voigt function. See Algorithm 916
* NCheb:        Number of Chebychev coefficients in the q.dat file
* nthmax:	Maximum number of threads per kernel launch. 
		In 2.0 GPUs it can not be larger than 32768. 
* nlmax:	Maximum number of molecular lines per kernel launch.
		Setting a lower number prevents from a time out on Desktop
machines
*qALPHA_L:	q value in the Lorentz half width q = Pself / P
*PROFILE:	1 = Voigt, 2 = Lorentz, 3 = Gauss

When using a Desktop GPU running an x session, the runtime of a single kernel
launch
can be limited to a few seconds. Chosing smaller values for nlmax and nthmax 
splitts the kernel into smaller parts. But it makes the Code a bit slower.


Input Files

The following input files must be provided:

* Line list files from HITRAN in ASCII format. For example the "01_hit12.par"
* for H2O

* "q.dat" file containing line by line for each Isotopologue the Chebychev
* coefficinets
  for the partition function. The number of coefficients must correspond to
the value
  "NCheb" in the define.h file

* The file "ISO.h" must contain the specifications for each Molecule:
** m.NL: The number of Lines in the line list file
** m.nISO: The number of Isotopologues per Molecule. It must correspond the
   HITRNN data files. For Example CO2 is limited to 10, not 11 as the web
version is.
** For each Isotopologue: id, AFGL id, Abundance, Q(296K), gj, Molar Mass(g).
   These values can be found in the "molparam.txt" file from HITRAN. id
   corresponds to the HITRAN Identity: first 2 characters are the Molecule id,
   third character is the order along the abundances.
   The AFGL id is the Molecule code. For example 161: 1H16O1H.
** The name of the corresponding line list file.


Output File
Two Output file are written:
*Out.dat: It contains the k function

*Out2.dat: It contains the sorted k function
